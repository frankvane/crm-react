{
    "sourceFile": "src/pages/user/Login/index.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1746089100321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746089120732,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import { Button, Form, Input } from \"antd\";\r\n+import { Button, Form, Input, message } from \"antd\";\r\n import { LockOutlined, UserOutlined } from \"@ant-design/icons\";\r\n \r\n import styles from \"./style.module.less\";\r\n import { useAuthStore } from \"@/store/modules/auth\";\r\n@@ -15,12 +15,15 @@\n   const login = useAuthStore((state) => state.login);\r\n \r\n   const handleSubmit = async (values: LoginParams) => {\r\n     try {\r\n-      await login(values);\r\n+      await login(values.username, values.password);\r\n+      message.success(\"登录成功\");\r\n       navigate(\"/dashboard\");\r\n     } catch (error) {\r\n-      console.error(\"登录失败:\", error);\r\n+      message.error(\r\n+        \"登录失败: \" + (error instanceof Error ? error.message : \"未知错误\")\r\n+      );\r\n     }\r\n   };\r\n \r\n   return (\r\n"
                },
                {
                    "date": 1746089454128,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,25 +1,30 @@\n import { Button, Form, Input, message } from \"antd\";\r\n import { LockOutlined, UserOutlined } from \"@ant-design/icons\";\r\n+import { useLocation, useNavigate } from \"react-router-dom\";\r\n \r\n import styles from \"./style.module.less\";\r\n import { useAuthStore } from \"@/store/modules/auth\";\r\n-import { useNavigate } from \"react-router-dom\";\r\n \r\n interface LoginParams {\r\n   username: string;\r\n   password: string;\r\n }\r\n \r\n const Login = () => {\r\n   const navigate = useNavigate();\r\n+  const location = useLocation();\r\n   const login = useAuthStore((state) => state.login);\r\n \r\n   const handleSubmit = async (values: LoginParams) => {\r\n     try {\r\n       await login(values.username, values.password);\r\n       message.success(\"登录成功\");\r\n-      navigate(\"/dashboard\");\r\n+      // 如果有保存的来源路径，就跳转回去，否则跳转到仪表盘\r\n+      const from =\r\n+        (location.state as { from?: Location })?.from?.pathname ||\r\n+        \"/app/dashboard\";\r\n+      navigate(from, { replace: true });\r\n     } catch (error) {\r\n       message.error(\r\n         \"登录失败: \" + (error instanceof Error ? error.message : \"未知错误\")\r\n       );\r\n"
                },
                {
                    "date": 1746089616426,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import { useLocation, useNavigate } from \"react-router-dom\";\r\n \r\n import styles from \"./style.module.less\";\r\n import { useAuthStore } from \"@/store/modules/auth\";\r\n+import { useState } from \"react\";\r\n \r\n interface LoginParams {\r\n   username: string;\r\n   password: string;\r\n@@ -13,10 +14,12 @@\n const Login = () => {\r\n   const navigate = useNavigate();\r\n   const location = useLocation();\r\n   const login = useAuthStore((state) => state.login);\r\n+  const [loading, setLoading] = useState(false);\r\n \r\n   const handleSubmit = async (values: LoginParams) => {\r\n+    setLoading(true);\r\n     try {\r\n       await login(values.username, values.password);\r\n       message.success(\"登录成功\");\r\n       // 如果有保存的来源路径，就跳转回去，否则跳转到仪表盘\r\n@@ -27,8 +30,10 @@\n     } catch (error) {\r\n       message.error(\r\n         \"登录失败: \" + (error instanceof Error ? error.message : \"未知错误\")\r\n       );\r\n+    } finally {\r\n+      setLoading(false);\r\n     }\r\n   };\r\n \r\n   return (\r\n@@ -61,9 +66,9 @@\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item>\r\n-          <Button type=\"primary\" htmlType=\"submit\" block>\r\n+          <Button type=\"primary\" htmlType=\"submit\" block loading={loading}>\r\n             登录\r\n           </Button>\r\n         </Form.Item>\r\n       </Form>\r\n"
                },
                {
                    "date": 1746091008910,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,8 +51,9 @@\n           <Input\r\n             prefix={<UserOutlined />}\r\n             placeholder=\"用户名\"\r\n             autoComplete=\"username\"\r\n+            value={\"admin\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item\r\n@@ -62,8 +63,9 @@\n           <Input.Password\r\n             prefix={<LockOutlined />}\r\n             placeholder=\"密码\"\r\n             autoComplete=\"current-password\"\r\n+            value={\"admin123\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item>\r\n"
                },
                {
                    "date": 1746091021119,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,8 @@\n           <Input\r\n             prefix={<UserOutlined />}\r\n             placeholder=\"用户名\"\r\n             autoComplete=\"username\"\r\n-            value={\"admin\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item\r\n@@ -63,9 +62,8 @@\n           <Input.Password\r\n             prefix={<LockOutlined />}\r\n             placeholder=\"密码\"\r\n             autoComplete=\"current-password\"\r\n-            value={\"admin123\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item>\r\n"
                },
                {
                    "date": 1746091034301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,8 +51,10 @@\n           <Input\r\n             prefix={<UserOutlined />}\r\n             placeholder=\"用户名\"\r\n             autoComplete=\"username\"\r\n+            // 设置默认值\r\n+            defaultValue={\"admin\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item\r\n@@ -62,8 +64,10 @@\n           <Input.Password\r\n             prefix={<LockOutlined />}\r\n             placeholder=\"密码\"\r\n             autoComplete=\"current-password\"\r\n+            // 设置默认值\r\n+            defaultValue={\"admin123\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item>\r\n"
                },
                {
                    "date": 1746091507088,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,8 +42,12 @@\n         name=\"login\"\r\n         onFinish={handleSubmit}\r\n         size=\"large\"\r\n         autoComplete=\"off\"\r\n+        initialValues={{\r\n+          username: \"admin\",\r\n+          password: \"admin123\",\r\n+        }}\r\n       >\r\n         <Form.Item\r\n           name=\"username\"\r\n           rules={[{ required: true, message: \"请输入用户名\" }]}\r\n@@ -51,9 +55,8 @@\n           <Input\r\n             prefix={<UserOutlined />}\r\n             placeholder=\"用户名\"\r\n             autoComplete=\"username\"\r\n-            defaultValue={\"admin\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item\r\n@@ -63,9 +66,8 @@\n           <Input.Password\r\n             prefix={<LockOutlined />}\r\n             placeholder=\"密码\"\r\n             autoComplete=\"current-password\"\r\n-            defaultValue={\"admin123\"}\r\n           />\r\n         </Form.Item>\r\n \r\n         <Form.Item>\r\n"
                }
            ],
            "date": 1746089100320,
            "name": "Commit-0",
            "content": "import { Button, Form, Input } from \"antd\";\r\nimport { LockOutlined, UserOutlined } from \"@ant-design/icons\";\r\n\r\nimport styles from \"./style.module.less\";\r\nimport { useAuthStore } from \"@/store/modules/auth\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\ninterface LoginParams {\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\nconst Login = () => {\r\n  const navigate = useNavigate();\r\n  const login = useAuthStore((state) => state.login);\r\n\r\n  const handleSubmit = async (values: LoginParams) => {\r\n    try {\r\n      await login(values);\r\n      navigate(\"/dashboard\");\r\n    } catch (error) {\r\n      console.error(\"登录失败:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      <Form<LoginParams>\r\n        name=\"login\"\r\n        onFinish={handleSubmit}\r\n        size=\"large\"\r\n        autoComplete=\"off\"\r\n      >\r\n        <Form.Item\r\n          name=\"username\"\r\n          rules={[{ required: true, message: \"请输入用户名\" }]}\r\n        >\r\n          <Input\r\n            prefix={<UserOutlined />}\r\n            placeholder=\"用户名\"\r\n            autoComplete=\"username\"\r\n          />\r\n        </Form.Item>\r\n\r\n        <Form.Item\r\n          name=\"password\"\r\n          rules={[{ required: true, message: \"请输入密码\" }]}\r\n        >\r\n          <Input.Password\r\n            prefix={<LockOutlined />}\r\n            placeholder=\"密码\"\r\n            autoComplete=\"current-password\"\r\n          />\r\n        </Form.Item>\r\n\r\n        <Form.Item>\r\n          <Button type=\"primary\" htmlType=\"submit\" block>\r\n            登录\r\n          </Button>\r\n        </Form.Item>\r\n      </Form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"
        }
    ]
}